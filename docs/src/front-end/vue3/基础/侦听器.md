# 侦听器

## 侦听数据源类型

watch 的第一个参数可以是不同形式的“数据源”：它可以是一个 ref (包括计算属性)、一个响应式对象、一个 getter 函数、或多个数据源组成的数组

> 不能直接侦听响应式对象的属性值

## 深层侦听器

直接给 watch() 传入一个响应式对象，会隐式地创建一个深层侦听器——该回调函数在所有嵌套的变更时都会被触发

一个返回响应式对象的 getter 函数，只有在返回不同的对象时，才会触发回调，可以显式地加上 deep 选项，强制转成深层侦听器

## 即时回调的侦听器

传入 immediate: true 选项来强制侦听器的回调立即执行

## 一次性侦听器

传入 once: true 选项

## watchEffect()

watchEffect() 允许我们自动跟踪回调的响应式依赖。

> watchEffect 仅会在其同步执行期间，才追踪依赖。在使用异步回调时，只有在第一个 await 正常工作前访问到的属性才会被追踪。

## 回调的触发时机

### Post Watchers

访问被 Vue 更新之后的所属组件的 DOM, 指明 flush: 'post' 选项

后置刷新的 watchEffect() 有个更方便的别名 watchPostEffect()

### 同步侦听器

同步触发的侦听器，它会在 Vue 进行任何更新之前触发，flush: 'sync'

同步触发的 `watchEffect()` 有个更方便的别名 `watchSyncEffect()`



## 停止侦听器

侦听器必须用**同步**语句创建：如果用异步回调创建一个侦听器，那么它不会绑定到当前组件上，你必须手动停止它，以防内存泄漏

要手动停止一个侦听器，请调用 `watch` 或 `watchEffect` 返回的函数




