# 正则表达式

用于匹配字符串中字符组合的模式，这些模式被用于RegExp的exec和test方法，以及String的match、replace、search和split方法。正则表达式具有灵活性、逻辑性和功能性强的特点，可以迅速地用极简单的方式达到字符串的复杂控制。在JavaScript中，正则表达式也是对象。


## 创建正则表达式

### 字面量

const reg = /abc/;

### 构造函数

const reg = new RegExp('abc');

## 语法

- ^  匹配字符串的行首

- $  匹配字符串的行尾

- 重复限定符  
```
 *    +    ？  {n}   {n,}    {n,m}
```

- 元字符   

```
.    \d    \w     \s    \b
```
  
  - .  匹配除换行符外的所有字符
  
  - \d 匹配数字字符与[0-9]一致，单词记忆法 => 数字（digital）
  
  - \w 匹配字母、数字和下划线，单词记忆法=> 单词（word）
  
  - \b  匹配一个边界，一个独立单词的开头或结尾，单词记忆法 => 边界（border）
    
    ```javascript
    const str = 'moon is white';
    
    console.log(str.match(/\bm/));     //['m']
    console.log(str.match(/oon\b/));     //['oon']
    ```
  
  - 匹配空白符（空格、换行符、制表符），单词记忆法 => 空白（space）、

- 反元字符   \[^x]   \D   \B    \W    \S
  
  - [^x]   匹配除x之外的任意字符
  - \D 匹配除数字外的任意字符
  - \W  匹配除数字、字母和下划线以外的任意字符，与\w相反
  - \B   匹配非单词边界的字符，与\b相反
  - \S    匹配非空白字符，与\s相反

- 字符组 [...]  匹配方括号中的字符集合，例如[0-9] => 匹配数字字符

- 分组 (...)  
  
  - (X) 将括号中的字符看成一个组进行匹配，例如(ab)+ => 可以匹配'ababab'
  
  - (?:X)   匹配X，但不记录匹配项。
  
  - (?=X)    正向肯定查找，即匹配后面紧跟X的字符串
    
    ```javascript
    const reg = /\d+(?=\.)/;
    
    console.log(reg.exec('3.141'))  //['3']
    ```
  
  - (?!X)  正向否定查找，匹配后面不跟X的字符，与正向肯定查找相反

- 多选符 |   匹配两者中的一个

- 转义字符  \   将特殊字符转义成普通文字

## 匹配方式

即正则表达式在匹配过程中，当具备多个结果时的处理方式。
匹配方式可分为两种，**贪婪模式**和**非贪婪模式。**

- 贪婪模式（默认）：即以限定符最大重复标准进行匹配。例如：使用/ba\*/匹配'baaaaa'时，结果可返回'baaaaa'*

``` js
const str = '12345678'
const reg = /\d{3,6}/g
str.replace(reg, 'X') // X78
```

- 非贪婪模式 ：一旦匹配成功不再继续尝试，只需要在量词后加上？即可

``` js
const str = '12345678'
const reg = /\d{3,6}?/g
str.replace(reg, 'X') // XX78
```

## 标识方式

就是正则表达式后面跟的匹配方式，flag

- g：全局匹配，记忆方式 => global
- i：忽略大小写，记忆方式 => ignore
- m：多行搜索，记忆方式 => multline

## 正则表达式相关方法

使用正则表达式的方式一共有6种，可以分成：reg有两种，string有四种。

### reg对象带的两种方法：exec和test

1. test   判断字符串中是否存在与正则表达式匹配的字符串，返回Boolean类型

2. exec 匹配字符串中满足条件的字符串，返回一个匹配的结果数组
   
   该方法是专门为捕获组而设计的，其接受一个参数，即要应用模式的字符串，然后返回包含第一个匹配项信息的数组；或者在没有匹配项的情况下返回`null`。返回的数组虽然是`Array`的实例，但是包含两个额外的属性：`index`和`input`。其中`index`表示匹配项在字符串中的位置，而`input`表示应用字符串表达式的字符串。
   
   对于`exec()`方法而言，即使在模式中设置了全局标志`g`，它每次也只是返回一个匹配项。在不设置全局标志的情况下，在同一个字符串上多次调用`exec()`方法将始终返回第一个匹配项的信息。而在设置全局标志的情况下，每次调用`exec()`则都会在字符串中继续查找新匹配项。
   
   > **扩展：正则表达式中的RegExp.$1**
   > 
   > `RegExp` 是`javascript`中的一个内置对象。为正则表达式。
   > `RegExp.$1`是RegExp的一个属性,指的是与正则表达式匹配的第一个子匹配(以括号为标志)字符串，以此类推，RegExp.2, RegExp.3, ..RegExp.$99总共可以有99个匹配。
   > 
   > 例如：
   > 
   > ```javascript
   > var r= /^(\d{4})-(\d{1,2})-(\d{1,2})$/; //正则表达式 匹配出生日期(简单匹配)    
   > r.exec('1985-10-15');
   > s1=RegExp.$1;
   > s2=RegExp.$2;
   > s3=RegExp.$3;
   > console.log(s1+" "+s2+" "+s3)//结果为1985 10 15
   > ```

### string的四种方法：match、search、replace、split

1. match 查找字符串中的匹配字符串，返回一个结果数组，若没有匹配则返回null
   
   如果 regexp 没有标志 g，那么 match() 方法就只能在 stringObject 中执行一次匹配。如果没有找到任何匹配的文本， match() 将返回 null。否则，它将返回一个数组。
   
   例如：
   
   ```javascript
   "186a619b28".match(/\d+/g); // ["186","619","28"] 
   ```
   
   如果上面的匹配不是全局匹配，那么得到的结果如下：
   `["186", index: 0, input: "186a619b28"]`

2. search 查找字符串中匹配的字符串，返回匹配字符串的下标，若没有则返回-1

3. replace 查找字符串中匹配的字符串，对其进行替换
   
   第1个参数可以是一个普通的字符串或是一个正则表达式.
   第2个参数可以是一个普通的字符串或是一个回调函数.
   
   如果第2个参数是字符串，那么每个匹配都将由字符串替换。但是字符串中的$字符具有特定的含义
   
   - $1、$2、...、$99  与regexp中的第 1 到第 99 个子表达式相匹配的文本。
   - $& 与regexp相匹配的子串
   - $` 位于匹配子串左侧的文本
   - $’ 位于匹配子串右侧的文本
   - $\$ 直接量符号
   
   如果第2个参数是回调函数，每匹配到一个结果就回调一次，每次回调都会传递以下参数：
   
   - result: 本次匹配到的结果
   - 1,...1,...9: 正则表达式中有几个()，就会传递几个参数，1 1 9分别代表本次匹配中每个()提取的结果，最多9个
   - offset:记录本次匹配的开始位置
   - source:接受匹配的原始字符串
   
   ```javascript
   // 接收字符串
   const str = 'this is reg expression test'
   
   console.log(str.replace(/\b(i.)\s(\w+)/, '$1 hello $2'));    //'this is hello reg expression test'
   ```

   // 接收函数，传入5个参数，第一个是匹配的字符串，第二个是第一项匹配的，第三个是第二项匹配的，第四个是匹配的下标，第五个是原字符串
   const str = 'this is reg expression test'

   str.replace(/\b(i.)\s(\w+)/, (...args) => {
      console.log(args);
   });    //["is reg", "is", "reg", 5, "this is reg expression test"]

4. split 使用正则表达式或者固定字符，分割字符串

## 捕获组

捕获组简单来说就是把正则表达式中用括号匹配的内容，保存到内存中，方便调用

js中每一个括号匹配的内容可以被RegExp对象捕获到（**最多匹配九个**，可以通过返回一个数组索引来取得所有的括号匹配项.），存储在RegExp.$1…中。需要说明的是正则表达式中（）不能匹配到内容的，就不是捕获组

### 具名捕获组

命名的方式是在左括号后面接 `?<名字>`

### 不对括号中的内容进行捕获

捕获组是会影响效率，有好多时候我们只是需要把括号里面当作一个整体。其实我们是不想要捕获的，使用的方式是 `?:`
